<link rel="import" href="bower_components/polymer/polymer.html">
<polymer-element name="synth3d-inspector">
    <template>
        
        <link rel="stylesheet" href="style.css">
        <style>
            button
            {
                margin: 5px;
                color : white;
                font-size : 1em;
                text-transform:uppercase;
                border : none;
                background-color : #0080FF;
                box-shadow : 0px 1px 3px rgba(0,0,0,0.5);
                cursor : pointer;
            }
        </style>
        
        <template bind if="{{block == null}}">
            <div class="info">Sélectionnez un bloc pour pouvoir l'éditer</div>
        </template>
        
        <template if="{{block.blockType == 'wave'}}">
            <div id="waveBlock" class="blocEditor">
                <h2>Bloc Oscillateur</h2>
                <div class="info">Ce bloc permet de générer un signal sinusoïdale</div>
                <h3>Type</h3>
                <div>
                    <button class="linkBlock" on-click={{setOscTypeToSine}}>Sine</button>
                    <button class="linkBlock" on-click={{setOscTypeToSquare}}>Square</button>
                    <button class="linkBlock" on-click={{setOscTypeToSawtooth}}>Sawtooth</button>
                    <button class="linkBlock" on-click={{setOscTypeToTriangle}}>Triangle</button>
                </div>
                <h3>Entrée</h3>
                <div><label>Fréquence d'entrée (Hz) : </label><input id="waveFreq" type="number" step="1" min="0" max="20000" value="{{block.audioNode.frequency.value}}"></div>
                <div><label>Amplitude d'entrée : </label><input id="waveAmp" type="number" step="0.1" min="0" max="100" value="{{block.audioNodeGain.gain.value}}"></div>
                </div>
                <h3>Sortie</h3>
                <div layout vertical>
                                <button class="linkBlock" on-click={{linkSignal}}>Lier le signal de sortie</button>                   </div>
            </div>
        </template>
        <template if="{{block.blockType == 'adsr'}}">
            <div id="adsrBlock" class="blocEditor">
                <h2>Bloc ADSR</h2>
                <div class="info">Ce bloc permet d'appliquer une enveloppe ADSR à un signal</div>
                <h3>Entrée</h3>
                <div><label for="">Attack : Amplitude</label><input type="number" step="any"></div>
                <div><label for="">Attack : Timing</label><input type="number" step="any"></div>
                <div><label for="">Decay : Amplitude</label><input type="number" step="any"></div>
                <div><label for="">Decay : Timing</label><input type="number" step="any"></div>
                <div><label for="">Sustain : Amplitude</label><input type="number" step="any"></div>
                <div><label for="">Sustain : Timing</label><input type="number" step="any"></div>
                <div><label for="">Release : Timing</label><input type="number" step="any"></div>
                <h3>Sortie</h3>
                <div layout vertical>
                                <button class="linkBlock" on-click={{linkSignal}}>Lier le signal de sortie</button>
                   </div>
            </div>
        </template>
        <template if="{{block.blockType == 'midi'}}">
            <div id="midiBlock" class="blocEditor">
                <h2>Bloc MIDI</h2>
                <div class="info">Ce bloc permet de générer un signal MIDI</div>
                <h3>Entrée</h3>
                <div><label for="">Note (0-127) : </label><input type="number" step="1" min="0" max="127" value="{{block.note}}"><button class="linkBlock" on-click={{updateFreq}}>Set</button></div>
                <h3>Sortie</h3>
                <div layout vertical>
                                <button class="linkBlock" on-click={{linkFreq}}>Lier la fréquence de sortie</button>                   </div>
            </div>
        </template>
        <template if="{{block.blockType == 'delay'}}">
            <div id="delayBlock" class="blocEditor">
                <h2>Bloc Délai</h2>
                <div class="info">Ce bloc permet d'ajouter un délai temporel à un signal</div>
                <h3>Entrée</h3>
                <div><label for="">Délai (sec) : </label><input type="number" step="0.1" min="0" max="10" value={{block.audioNode.delayTime.value}}></div>
                <div><label for="">Gain : </label><input type="number" step="0.1" min="0" max="1" value={{block.audioNodeGain.gain.value}}></div>
                <h3>Sortie</h3>
                <div layout vertical>
                                <button class="linkBlock" on-click={{linkSignal}}>Lier le signal de sortie</button>                   </div>
            </div>
        </template>
        <template if="{{block.blockType == 'listener'}}">
            <div id="delayBlock" class="blocEditor">
                <h2>Bloc Listener</h2>
                <div class="info">Ce bloc envoie les signaux d'entrée à la sortie son</div>
                <h3>Entrée</h3>
                <div><label for="">Volume : </label><input type="number" step="0.1" min="0" max="1" value={{block.audioNodeGain.gain.value}}></div>
            </div>
        </template>
    </template>
    <script>
        Polymer({
            block : null,
            linkSignal : function()
            {
                var blockToLink = this.block;
                window.currentTool.setBlock(null);
                window.currentTool = Tools.linkTool;
                window.currentTool.setType('signal');
                window.currentTool.setBlock(blockToLink);
            },
            linkFreq : function()
            {
                var blockToLink = this.block;
                window.currentTool.setBlock(null);
                window.currentTool = Tools.linkTool;
                window.currentTool.setType('freq');
                window.currentTool.setBlock(blockToLink);
            },
            updateFreq : function()
            {
                this.block.updateFrequencies();
            },
            setOscTypeToSine : function()
            {
                this.block.audioNode.type = "sine";
            },
            setOscTypeToSquare : function()
            {
                this.block.audioNode.type = "square";
            },
            setOscTypeToSawtooth : function()
            {
                this.block.audioNode.type = "sawtooth";
            },
            setOscTypeToTriangle : function()
            {
                this.block.audioNode.type = "triangle";
            }
        });
    </script>
</polymer-element>